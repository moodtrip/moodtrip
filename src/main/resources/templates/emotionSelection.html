<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="icon" href="/images/moodtrip.png"/>
    <link rel="apple-touch-icon" href="/images/moodtrip.png"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>감정 선택 - MOODTRIP</title>
    <style>

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;

            /* "더 어두운 흰색"으로 수정된 애니메이션 */
            background: linear-gradient(135deg,
                /* 1. 블루/스카이 */
            #a1c4fd, #c2e9fb,
            #f0f0f0, /* 흰색 대체 (더 어두운 회색) */
                /* 2. 핑크/퍼플 */
            #fbc2eb, #a6c1ee,
            #f0f0f0, /* 흰색 대체 (더 어두운 회색) */
                /* 3. (녹색 대체) 피치/옐로우 */
            #fde7c8, #fdf6d2,
            #f0f0f0, /* 흰색 대체 (더 어두운 회색) */
                /* 4. 핑크 -> 코랄 */
            #fbc2eb, #fad0c4,
            #f0f0f0, /* 흰색 대체 (더 어두운 회색) */
                /* 5. 코랄/라벤더 */
            #fad0c4, #ffd1ff,
            #f0f0f0, /* 흰색 대체 (더 어두운 회색) */
                /* 6. 다시 블루로 순환 */
            #a1c4fd, #c2e9fb
            );

            /* 그라데이션 크기를 10개 구간에 맞게 키웁니다. */
            background-size: 1000% 1000%;
            /* 30초(약 3초 * 10구간) 동안 그라데이션을 이동시킵니다. */
            animation: gradientShift 30s ease-in-out infinite;

            min-height: 100vh;
            /* body의 기본 color는 #333 (내부 컨텐츠 기준) */
            color: #333;
            padding: 80px 10px 5px 10px; /* 상단에 헤더 공간 확보 */
            box-sizing: border-box;
            display: flex; /* 컨테이너 중앙 정렬 */
            justify-content: center;
            align-items: flex-start; /* 컨테이너를 위쪽에 배치 */
        }

        .header {
            text-align: center;
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.75); /* 0.95 -> 0.75 */
            backdrop-filter: blur(10px);
            z-index: 100;
            padding: 10px;
            margin: -20px; /* container paddingに合わせて調整 */
            border-radius: 45px 45px 0 0;
        }

        /* Header 스타일 */
        #header-logo {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1500;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 15px 20px 0;
        }

        #logo img {
            height: 50px;
            width: auto;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }

        .header-line {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.5) 50%, transparent 100%);
            margin: 15px 0 0 0;
            width: 100%;
        }

        .container {
            background: rgba(255, 255, 255, 0.75); /* 0.95 -> 0.75 */
            backdrop-filter: blur(10px);
            border-radius: 45px;
            padding: 20px;
            width: 100%;
            max-width: 1200px;
            margin: 10px auto auto auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.6s ease-out;
            display: flex; /* 내부 요소 정렬 */
            flex-direction: column;
            max-height: calc(100vh - 95px); /* 헤더 및 여백 제외한 최대 높이 */
        }

        .page-header {
            text-align: center;
            position: sticky; /* 상단 고정 */
            top: 0;
            background: rgba(255, 255, 255, 0.75); /* 0.95 -> 0.75 */
            backdrop-filter: blur(10px);
            z-index: 100;
            padding: 10px;
            margin: -5px;
            border-radius: 45px 45px 0 0;
        }

        .title {
            font-size: 32px;
            font-weight: bold;
            margin: 5px;
            color: #2c3e50;
            padding-top: 15px; /* 헤더 패딩 보정 */
        }

        .subtitle {
            font-size: 18px;
            margin: 10px;
            color: #666;
        }

        .instruction {
            font-size: 16px;
            color: #888;
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin-bottom: 10px; /* 카운터와 간격 */
        }
        .selected-counter {
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            color: #89b3f8; /* 파스텔 블루 */
            background: rgba(161, 196, 253, 0.1); /* 파스텔 블루 */
            padding: 12px 24px;
            border-radius: 25px;
            display: inline-block;
            min-width: 200px;
            margin-bottom: 10px; /* 아래 영역과 간격 */
        }


        .content-area {
            /* max-height 제거 -> flex-grow로 대체 */
            flex-grow: 1; /* 남은 공간 채우기 */
            overflow-y: auto;
            padding: 25px 20px 10px 20px;
        }

        .content-area::-webkit-scrollbar {
            width: 8px;
        }

        .content-area::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .content-area::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #a1c4fd, #c2e9fb); /* 스크롤바 색상도 파스텔톤으로 */
            border-radius: 10px;
        }

        .content-area::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #89b3f8, #b0e0f8);
        }

        .emotion-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .emotion-item {
            position: relative;
        }

        .emotion-checkbox {
            display: none;
        }

        .emotion-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2.5px;
            border: 3px solid #e0e0e0;
            border-radius: 40px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: white;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 140px;
            justify-content: center;
        }

        .emotion-label::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .emotion-label:hover::before {
            left: 100%;
        }

        .emotion-label:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
            border-color: #a1c4fd; /* 호버 색상 변경 */
        }

        .emotion-checkbox:checked + .emotion-label {
            background: linear-gradient(135deg, #a1c4fd, #c2e9fb); /* 체크 시 색상 변경 */
            color: white;
            border-color: #a1c4fd;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(161, 196, 253, 0.3);
        }

        .emotion-checkbox:checked + .emotion-label .emotion-icon {
            transform: scale(1.2);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
        }

        .emotion-icon {
            font-size: 48px;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .emotion-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        /* 체크 시 텍스트 색상 */
        .emotion-checkbox:checked + .emotion-label .emotion-name,
        .emotion-checkbox:checked + .emotion-label .emotion-desc {
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }


        .emotion-desc {
            font-size: 13px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .fixed-bottom {
            position: sticky; /* 하단 고정 */
            bottom: 0;
            background: rgba(255, 255, 255, 0.75); /* 0.95 -> 0.75 */
            backdrop-filter: blur(10px);
            padding: 10px; /* 버튼과 간격 확보 */
            margin: -5px; /* container paddingに合わせて調整 */
            border-radius: 0 0 45px 45px;
            z-index: 100;
            text-align: center; /* 내부 버튼 중앙 정렬 */
        }


        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .btn {
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #a1c4fd, #c2e9fb); /* 파스텔 블루 */
            color: white;
            opacity: 0.5;
            pointer-events: none;
        }

        .btn-primary.active {
            opacity: 1;
            pointer-events: all;
        }

        .btn-primary.active:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(161, 196, 253, 0.4);
        }

        .btn-secondary {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            border: 2px solid #6c757d;
        }

        .btn-secondary:hover {
            background: #6c757d;
            color: white;
            transform: translateY(-3px);
        }

        .checkmark {
            position: absolute;
            top: 15px;
            right: 20px;
            width: 25px;
            height: 25px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: #a1c4fd; /* 파스텔 블루 */
            opacity: 0;
            transition: all 0.3s ease;
        }

        .emotion-checkbox:checked + .emotion-label .checkmark {
            opacity: 1;
            background: white;
            color: #a1c4fd; /* 파스텔 블루 */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .emotion-item {
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
        }

        /* 스태거드 애니메이션 */
        .emotion-item:nth-child(1) { animation-delay: 0.05s; }
        .emotion-item:nth-child(2) { animation-delay: 0.1s; }
        .emotion-item:nth-child(3) { animation-delay: 0.15s; }
        .emotion-item:nth-child(4) { animation-delay: 0.2s; }
        .emotion-item:nth-child(5) { animation-delay: 0.25s; }
        .emotion-item:nth-child(6) { animation-delay: 0.3s; }
        .emotion-item:nth-child(7) { animation-delay: 0.35s; }
        .emotion-item:nth-child(8) { animation-delay: 0.4s; }
        .emotion-item:nth-child(9) { animation-delay: 0.45s; }
        .emotion-item:nth-child(10) { animation-delay: 0.5s; }
        .emotion-item:nth-child(11) { animation-delay: 0.55s; }
        .emotion-item:nth-child(12) { animation-delay: 0.6s; }
        .emotion-item:nth-child(n+13) { animation-delay: 0.65s; }

        #loadingOverlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            z-index: 9999;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            color: #333;
            border-radius: 45px; /* 곡률 추가 */
        }

        /* 개선된 로딩 스피너 */
        .loader {
            position: relative;
            width: 60px;
            height: 60px;
            animation: loader-rotate 0.8s infinite linear;
            margin-bottom: 40px;
        }

        .loader:before,
        .loader:after {
            content: '';
            position: absolute;
            margin: -30px 0 0 -30px;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            background-color: #a1c4fd; /* 파스텔 블루 */
            border-radius: 50%;
            animation: loader-bounce 1.5s infinite ease-in-out;
        }

        .loader:after {
            background-color: #c2e9fb; /* 파스텔 스카이 */
            animation-direction: reverse;
        }

        @keyframes loader-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes loader-bounce {
            0% { transform: scale(0.2); left: 0%; }
            50% { transform: scale(1.0); left: 50%; }
            100% { transform: scale(0.2); left: 100%; }
        }

        /* === 개선된 텍스트 애니메이션 컨테이너 === */
        .loading-text-container {
            text-align: center;
            max-width: 600px;
            padding: 0 30px;
            width: 100%;
        }

        /* 개선된 메인 텍스트 - 색상 안정화, 자동 개행 */
        .loading-main-text {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
            min-height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            line-height: 1.4;
            word-wrap: break-word;
            word-break: keep-all;
            white-space: normal;
            max-width: 100%;
        }

        /* 개선된 서브 텍스트 - 자동 개행 */
        .loading-sub-text {
            font-size: 17px;
            color: #666;
            min-height: 60px;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            word-wrap: break-word;
            word-break: keep-all;
            white-space: normal;
            max-width: 100%;
        }

        /* === 개선된 애니메이션 효과들 === */

        /* 타이핑 효과 - 색상 고정, 자동 개행 */
        .typing-effect {
            border-right: 2px solid #a1c4fd; /* 파스텔 블루 */
            animation: blink 1s infinite;
            overflow: visible;
            white-space: normal;
        }

        @keyframes blink {
            0%, 50% { border-color: #a1c4fd; } /* 파스텔 블루 */
            51%, 100% { border-color: transparent; }
        }

        /* 페이드 효과 - 안정적인 색상 */
        .fade-effect {
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            color: #2c3e50;
        }

        .fade-effect.active {
            opacity: 1;
        }

        /* 슬라이드 효과 - 안정적인 색상 */
        .slide-effect {
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.6s ease-out;
            color: #2c3e50;
        }

        .slide-effect.active {
            transform: translateY(0);
            opacity: 1;
        }

        /* 색상 변화 효과 - 부드럽게 개선 */
        .color-changing {
            background: linear-gradient(90deg, #a1c4fd, #fbc2eb, #a1c4fd); /* 파스텔 계열 */
            background-size: 300% 100%;
            animation: gradientMove 3s ease-in-out infinite;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* 점 애니메이션 */
        .dots::after {
            content: '';
            animation: dotsAnimation 1.5s steps(4, end) infinite;
        }

        @keyframes dotsAnimation {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        /* 진행 바 */
        .progress-container {
            width: 100%;
            max-width: 400px;
            height: 6px;
            background: rgba(161, 196, 253, 0.15); /* 파스텔 블루 */
            border-radius: 10px;
            margin: 30px auto 0 auto;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #a1c4fd, #c2e9fb); /* 파스텔 블루 */
            border-radius: 10px;
            width: 0%;
            animation: progressMove 8s ease-in-out infinite;
        }

        @keyframes progressMove {
            0% { width: 0%; }
            20% { width: 25%; }
            40% { width: 50%; }
            60% { width: 75%; }
            80% { width: 90%; }
            100% { width: 100%; }
        }

        /* 텍스트가 길 때를 위한 추가 스타일 */
        .long-text {
            font-size: 20px !important;
            line-height: 1.4 !important;
            max-width: 90% !important;
        }

        .long-text.loading-sub-text {
            font-size: 16px !important;
            line-height: 1.5 !important;
        }

        /* 애니메이션 중 텍스트 안정성 보장 */
        .stable-color {
            color: #2c3e50 !important;
            -webkit-text-fill-color: #2c3e50 !important;
        }

        /* 서브 텍스트 색상 안정화 */
        .stable-sub-color {
            color: #666 !important;
            -webkit-text-fill-color: #666 !important;
        }

        /* 반응형 디자인 */
        @media (max-width: 768px) {
            body {
                padding: 70px 10px 5px 10px;
            }

            #header-logo {
                padding: 12px 15px 0;
            }

            #logo img {
                height: 40px;
            }

            .header-line {
                margin: 12px 0 0 0;
            }

            .container {
                padding: 20px;
                border-radius: 35px; /* 모바일 곡률 */
            }
            #loadingOverlay {
                border-radius: 35px; /* 모바일 곡률 */
            }

            .page-header {
                margin: -5px;
                border-radius: 35px 35px 0 0;
            }
            .fixed-bottom {
                margin: -5px;
                border-radius: 0 0 35px 35px;
            }


            .title {
                font-size: 28px;
            }

            .emotion-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 15px;
            }

            .emotion-label {
                padding: 18px 15px;
                min-height: 130px;
            }

            .emotion-icon {
                font-size: 42px;
                margin-bottom: 10px;
            }

            .emotion-name {
                font-size: 16px;
            }

            .emotion-desc {
                font-size: 12px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .btn {
                padding: 12px 30px;
                font-size: 16px;
            }

            .content-area {
                /* (100vh - 헤더공간 70px - 컨테이너마진 10px - 바디패딩 5px) */
                max-height: calc(100vh - 85px);
            }

            /* 로딩 텍스트 반응형 */
            .loading-text-container {
                padding: 0 20px;
                max-width: 90%;
            }

            .loading-main-text {
                font-size: 20px;
                min-height: 30px;
            }

            .loading-sub-text {
                font-size: 15px;
                min-height: 50px;
            }

            .loader {
                width: 50px;
                height: 50px;
                margin-bottom: 30px;
            }

            .loader:before,
            .loader:after {
                width: 20px;
                height: 20px;
                margin: -25px 0 0 -25px;
            }

            .progress-container {
                max-width: 300px;
                height: 5px;
                margin-top: 25px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 60px 10px 5px 10px;
            }

            #header-logo {
                padding: 10px 10px 0;
            }

            #logo img {
                height: 35px;
            }

            .header-line {
                margin: 10px 0 0 0;
            }

            .container {
                padding: 20px;
                margin: 10px;
                border-radius: 30px;
            }
            #loadingOverlay {
                border-radius: 30px; /* 모바일 곡률 */
            }

            .page-header {
                margin: -5px;
                border-radius: 30px 30px 0 0;
            }
            .fixed-bottom {
                margin: -5px;
                border-radius: 0 0 30px 30px;
            }


            .emotion-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .emotion-label {
                padding: 15px 10px;
                min-height: 120px;
            }

            .emotion-icon {
                font-size: 36px;
            }

            .loading-text-container {
                padding: 0 15px;
            }

            .loading-main-text {
                font-size: 18px;
                line-height: 1.3;
            }

            .loading-sub-text {
                font-size: 14px;
                line-height: 1.5;
            }

            .progress-container {
                max-width: 250px;
                margin-top: 20px;
            }
        }

        /* 배경 효과 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                    radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
    </style>
</head>

<body>
<header id="header-logo">
    <div id="logo">
        <a th:href="@{/}">
            <img src="/images/moodtrip-logo-short.png" alt="MOODTRIP">
        </a>
    </div>
    <hr class="header-line">
</header>
<div class="container">
    <div class="page-header">
        <h1 class="title">현재 기분을 선택해주세요</h1>
        <p class="subtitle">당신의 감정에 맞는 완벽한 장소를 찾아드릴게요</p>
        <div class="instruction">여러 개 선택 가능 (최소 1개)</div>

        <div class="selected-counter">
            <span id="counterText">선택된 감정: 0개</span>
        </div>
    </div>

    <div class="content-area">
        <form id="emotionForm" th:action="@{/processEmotion}" method="post">
            <input type="hidden" name="lat" th:value="${latitude}">
            <input type="hidden" name="lng" th:value="${longitude}">
            <div class="emotion-grid">
                <div class="emotion-item">
                    <input type="checkbox" id="joy" name="emotions" value="기쁨" class="emotion-checkbox">
                    <label for="joy" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128522;</div>
                        <div class="emotion-name">기쁨</div>
                        <div class="emotion-desc">즐거운 마음과 행복을 느끼는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="pride" name="emotions" value="고소함" class="emotion-checkbox">
                    <label for="pride" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128521;</div>
                        <div class="emotion-name">뿌듯함</div>
                        <div class="emotion-desc">자신감 있고 뿌듯한 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="thrill" name="emotions" value="박진감" class="emotion-checkbox">
                    <label for="thrill" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128293;</div>
                        <div class="emotion-name">박진감</div>
                        <div class="emotion-desc">짜릿하고 신나는 순간</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="fun" name="emotions" value="즐거움" class="emotion-checkbox">
                    <label for="fun" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#127881;</div>
                        <div class="emotion-name">즐거움</div>
                        <div class="emotion-desc">행복하고 유쾌한 기분</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="happy" name="emotions" value="행복함" class="emotion-checkbox">
                    <label for="happy" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128522;</div>
                        <div class="emotion-name">행복함</div>
                        <div class="emotion-desc">마음이 따뜻해지고 만족스러운 상태</div>
                    </label>
                </div>

                <div class="emotion-item">
                    <input type="checkbox" id="love" name="emotions" value="사랑" class="emotion-checkbox">
                    <label for="love" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128149;</div>
                        <div class="emotion-name">사랑</div>
                        <div class="emotion-desc">따뜻하고 깊은 애정을 느끼는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="care" name="emotions" value="배려" class="emotion-checkbox">
                    <label for="care" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128591;</div>
                        <div class="emotion-name">배려</div>
                        <div class="emotion-desc">다른 사람을 생각하는 따뜻한 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="hope" name="emotions" value="희망" class="emotion-checkbox">
                    <label for="hope" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#127775;</div>
                        <div class="emotion-name">희망</div>
                        <div class="emotion-desc">밝은 미래를 기대하는 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="desire" name="emotions" value="욕망" class="emotion-checkbox">
                    <label for="desire" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128293;</div>
                        <div class="emotion-name">욕망</div>
                        <div class="emotion-desc">무언가를 강하게 원하고 갈망하는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="confidence" name="emotions" value="자신감" class="emotion-checkbox">
                    <label for="confidence" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128170;</div>
                        <div class="emotion-name">자신감</div>
                        <div class="emotion-desc">당당하게 행동할 수 있는 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="curiosity" name="emotions" value="호기심" class="emotion-checkbox">
                    <label for="curiosity" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#129300;</div>
                        <div class="emotion-name">호기심</div>
                        <div class="emotion-desc">새로운 것을 탐험하고 싶은 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="excitement" name="emotions" value="설렘" class="emotion-checkbox">
                    <label for="excitement" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128525;</div>
                        <div class="emotion-name">설렘</div>
                        <div class="emotion-desc">두근거리고 기대되는 마음</div>
                    </label>
                </div>

                <div class="emotion-item">
                    <input type="checkbox" id="anger" name="emotions" value="분노" class="emotion-checkbox">
                    <label for="anger" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128545;</div>
                        <div class="emotion-name">분노</div>
                        <div class="emotion-desc">화를 느끼고 불쾌한 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="resentment" name="emotions" value="원망" class="emotion-checkbox">
                    <label for="resentment" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128561;</div>
                        <div class="emotion-name">원망</div>
                        <div class="emotion-desc">누군가에게 섭섭함을 느끼는 감정</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="jealousy" name="emotions" value="질투" class="emotion-checkbox">
                    <label for="jealousy" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128568;</div>
                        <div class="emotion-name">질투</div>
                        <div class="emotion-desc">남을 부러워하며 불쾌한 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="disgust" name="emotions" value="불쾌" class="emotion-checkbox">
                    <label for="disgust" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128128;</div>
                        <div class="emotion-name">불쾌</div>
                        <div class="emotion-desc">기분이 좋지 않고 짜증나는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="boredom" name="emotions" value="권태" class="emotion-checkbox">
                    <label for="boredom" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128560;</div>
                        <div class="emotion-name">무기력</div>
                        <div class="emotion-desc">무기력하고 흥미가 없는 상태</div>
                    </label>
                </div>

                <div class="emotion-item">
                    <input type="checkbox" id="sadness" name="emotions" value="슬픔" class="emotion-checkbox">
                    <label for="sadness" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128542;</div>
                        <div class="emotion-name">슬픔</div>
                        <div class="emotion-desc">마음이 아프고 우울한 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="nostalgia" name="emotions" value="그리움" class="emotion-checkbox">
                    <label for="nostalgia" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#129402;</div>
                        <div class="emotion-name">그리움</div>
                        <div class="emotion-desc">잃어버린 것을 아쉬워하는 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="despair" name="emotions" value="절망" class="emotion-checkbox">
                    <label for="despair" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128557;</div>
                        <div class="emotion-name">절망</div>
                        <div class="emotion-desc">희망이 사라지고 막막한 감정</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="regret" name="emotions" value="후회" class="emotion-checkbox">
                    <label for="regret" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128533;</div>
                        <div class="emotion-name">후회</div>
                        <div class="emotion-desc">이미 지나간 일을 아쉬워하는 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="lament" name="emotions" value="한탄" class="emotion-checkbox">
                    <label for="lament" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128577;</div>
                        <div class="emotion-name">한탄</div>
                        <div class="emotion-desc">억울하거나 안타까운 마음</div>
                    </label>
                </div>

                <div class="emotion-item">
                    <input type="checkbox" id="pain" name="emotions" value="아픔" class="emotion-checkbox">
                    <label for="pain" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128565;</div>
                        <div class="emotion-name">아픔</div>
                        <div class="emotion-desc">신체적/정신적 고통을 느끼는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="lonely" name="emotions" value="외로움" class="emotion-checkbox">
                    <label for="lonely" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128546;</div>
                        <div class="emotion-name">외로움</div>
                        <div class="emotion-desc">혼자여서 느끼는 쓸쓸함</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="stress" name="emotions" value="스트레스" class="emotion-checkbox">
                    <label for="stress" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128565;</div>
                        <div class="emotion-name">스트레스</div>
                        <div class="emotion-desc">마음이 긴장되고 지친 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="frustration" name="emotions" value="답답함" class="emotion-checkbox">
                    <label for="frustration" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128560;</div>
                        <div class="emotion-name">답답함</div>
                        <div class="emotion-desc">해결되지 않아 답답한 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="bored" name="emotions" value="지루함" class="emotion-checkbox">
                    <label for="bored" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128530;</div>
                        <div class="emotion-name">지루함</div>
                        <div class="emotion-desc">관심이 없어 심심한 상태</div>
                    </label>
                </div>

                <div class="emotion-item">
                    <input type="checkbox" id="anxiety" name="emotions" value="불안" class="emotion-checkbox">
                    <label for="anxiety" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128552;</div>
                        <div class="emotion-name">불안</div>
                        <div class="emotion-desc">앞일이 걱정되는 마음</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="fear" name="emotions" value="두려움" class="emotion-checkbox">
                    <label for="fear" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128561;</div>
                        <div class="emotion-name">두려움</div>
                        <div class="emotion-desc">위험이나 결과가 걱정되는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="worry" name="emotions" value="걱정" class="emotion-checkbox">
                    <label for="worry" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128533;</div>
                        <div class="emotion-name">걱정</div>
                        <div class="emotion-desc">마음이 안정되지 못하고 불안함</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="nervous" name="emotions" value="초조" class="emotion-checkbox">
                    <label for="nervous" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128552;</div>
                        <div class="emotion-name">초조</div>
                        <div class="emotion-desc">결과를 기다리며 긴장되는 상태</div>
                    </label>
                </div>
                <div class="emotion-item">
                    <input type="checkbox" id="shame" name="emotions" value="부끄러움" class="emotion-checkbox">
                    <label for="shame" class="emotion-label">
                        <div class="checkmark">&#10003;</div>
                        <div class="emotion-icon">&#128557;</div>
                        <div class="emotion-name">부끄러움</div>
                        <div class="emotion-desc">실수나 잘못으로 민망한 상태</div>
                    </label>
                </div>
            </div>
        </form>
    </div>

    <div class="fixed-bottom">
        <div class="action-buttons">
            <button type="submit" form="emotionForm" class="btn btn-primary" id="submitBtn">
                장소 추천받기
            </button>
            <a href="/" class="btn btn-secondary">
                ← 선택으로 돌아가기
            </a>
        </div>
    </div>

    <div id="loadingOverlay">
        <div class="loader"></div>
        <div class="loading-text-container">
            <div class="loading-main-text" id="mainText"></div>
            <div class="loading-sub-text" id="subText"></div>
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // === 개선된 로딩 텍스트 애니메이션 (감정 선택용) === //

    const mainTexts = [
        "당신의 감정을 분석하고 있어요",
        "맞춤 추천을 준비하고 있어요",
        "적절한 장소를 찾고 있어요",
        "특별한 장소들을 선별하고 있어요",
        "거의 완료되었어요"
    ];

    const subTexts = [
        "선택하신 감정들을 바탕으로 최적의 장소를 찾고 있습니다",
        "위치 정보와 취향을 고려하여 개인화된 추천을 만들고 있습니다",
        "많은 장소 중에서 당신에게 적절한 장소를 골라내고 있어요",
        "리뷰와 평점, 분위기까지 고려한 특별한 장소들을 준비하고 있어요",
        "잠시만 기다려주세요. 곧 멋진 장소들을 보여드릴게요!"
    ];

    let currentIndex = 0;
    let isAnimating = false;

    // 텍스트 크기 일관성 유지
    function applyConsistentTextSize(mainElement, subElement) {
        mainElement.classList.add('consistent-text-size');
        subElement.classList.add('consistent-sub-text-size');
    }

    // 타이핑 효과
    function typeText(element, text, speed = 50) {
        return new Promise((resolve) => {
            element.innerHTML = '';
            element.classList.add('typing-effect', 'stable-color');

            let i = 0;
            const timer = setInterval(() => {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                } else {
                    element.classList.remove('typing-effect');
                    clearInterval(timer);
                    resolve();
                }
            }, speed);
        });
    }

    // 페이드 효과
    function fadeInText(element, text, isSubText = false) {
        return new Promise((resolve) => {
            element.classList.add('fade-effect');
            if (isSubText) {
                element.classList.add('stable-sub-color');
            } else {
                element.classList.add('stable-color');
            }

            element.innerHTML = text.replace(/\n/g, '<br>');

            setTimeout(() => {
                element.classList.add('active');
                setTimeout(resolve, 800);
            }, 100);
        });
    }

    // 슬라이드 효과
    function slideInText(element, text, isSubText = false) {
        return new Promise((resolve) => {
            element.classList.add('slide-effect');
            if (isSubText) {
                element.classList.add('stable-sub-color');
            } else {
                element.classList.add('stable-color');
            }

            element.innerHTML = text.replace(/\n/g, '<br>');

            setTimeout(() => {
                element.classList.add('active');
                setTimeout(resolve, 600);
            }, 100);
        });
    }

    // 색상 변화 효과
    function colorChangeText(element, text) {
        return new Promise((resolve) => {
            element.classList.add('color-changing');
            element.innerHTML = text.replace(/\n/g, '<br>');
            setTimeout(resolve, 1500);
        });
    }

    // 효과 초기화
    function resetTextEffects(element) {
        element.classList.remove(
            'fade-effect', 'active', 'slide-effect', 'color-changing',
            'typing-effect', 'stable-color', 'stable-sub-color'
        );
    }

    // 메인 애니메이션 함수
    async function animateTexts() {
        if (isAnimating) return;
        isAnimating = true;

        const mainTextEl = document.getElementById('mainText');
        const subTextEl = document.getElementById('subText');

        // 크기 일관성 적용
        applyConsistentTextSize(mainTextEl, subTextEl);

        for (let i = 0; i < mainTexts.length; i++) {
            currentIndex = i;

            resetTextEffects(mainTextEl);
            resetTextEffects(subTextEl);

            const effects = ['typing', 'fade', 'slide', 'color'];
            const currentEffect = effects[i % effects.length];

            switch (currentEffect) {
                case 'typing':
                    await typeText(mainTextEl, mainTexts[i], 60);
                    await fadeInText(subTextEl, subTexts[i], true);
                    break;

                case 'fade':
                    await fadeInText(mainTextEl, mainTexts[i], false);
                    await slideInText(subTextEl, subTexts[i], true);
                    break;

                case 'slide':
                    await slideInText(mainTextEl, mainTexts[i], false);
                    await fadeInText(subTextEl, subTexts[i], true);
                    break;

                case 'color':
                    await colorChangeText(mainTextEl, mainTexts[i]);
                    await typeText(subTextEl, subTexts[i], 40);
                    subTextEl.classList.add('stable-sub-color');
                    break;
            }

            if (i < mainTexts.length - 1) {
                await new Promise(resolve => setTimeout(resolve, 2000));
            }
        }

        const finalText = document.createElement('span');
        finalText.innerHTML = mainTexts[mainTexts.length - 1] + '<span class="dots"></span>';
        finalText.className = 'stable-color';
        mainTextEl.innerHTML = '';
        mainTextEl.appendChild(finalText);

        isAnimating = false;
    }

    // === 감정 선택 폼 제출 처리 === //
    const checkboxes = document.querySelectorAll('.emotion-checkbox');
    const submitBtn = document.getElementById('submitBtn');
    const counterText = document.getElementById('counterText');

    function updateCounter() {
        const checkedCount = document.querySelectorAll('.emotion-checkbox:checked').length;
        counterText.textContent = `선택된 감정: ${checkedCount}개`;

        if (checkedCount > 0) {
            submitBtn.classList.add('active');
        } else {
            submitBtn.classList.remove('active');
        }
    }

    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', updateCounter);
    });

    document.getElementById('emotionForm').addEventListener('submit', function(e) {
        const checkedCount = document.querySelectorAll('.emotion-checkbox:checked').length;
        if (checkedCount === 0) {
            e.preventDefault();
            alert('최소 하나의 감정을 선택해주세요!');
        } else {
            document.getElementById('loadingOverlay').style.display = 'flex';
            animateTexts();
        }
    });

    // 초기 상태 설정
    updateCounter();
</script>
</body>
</html>